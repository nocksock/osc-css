<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>
  </title>
  <link rel="stylesheet" href="./osc.css">
  <link rel="stylesheet" href="./assets/demo.css">
</head>
<body>
    <header>
      <h1>OSC<span>.</span>CSS</h1>
      <p>
        CSS properties to animate numeric values where they are needed using oscillators and envelopes.
      </p>

      <p>
        Docs on <a href="http://github.com/nocksock/osc-css">GitHub</a>
      </p>
    </header>

    <main>
      <article>
        <h3>Basic Usage</h3>
        <p>
          Quickly create animations without defining keyframes:
        </p>

        <figure id="basic" class="">
          <style contenteditable="plaintext-only" spellcheck="false">
          #basic {
            osc-ball {
              animation: var(--osc);
              --osc-phase: 0.25s; 
              translate: 0 calc(var(--osc-sin) * 100px);
            }
          }
          </style>
          <osc-stage class="ch">
            <osc-ball></osc-ball>
          </osc-stage>
        </figure>
      </article>

      <article>
        <h3>Using an envelope</h3>
        <p>
          Use an envelope to control the amplitude of the oscillation.
          Also show how to use multiple oscillators.
          Even just 2 oscillators can create complex animations.
        </p>

        <figure id="envelope" class="">
          <style contenteditable="plaintext-only" spellcheck="false">
          #envelope {
            osc-ball {
              animation: var(--osc);
              --osc-cos-phase: 0.25s;
              translate: 
                calc(var(--osc-cos) * 100px * var(--osc-env))
                calc(var(--osc-tri) * 200px * var(--osc-env))
              ;
            }
          }
          </style>
          <osc-stage class="ch">
            <osc-ball></osc-ball>
          </osc-stage>
        </figure>
      </article>

      <article>
        <h3>Waveform</h3>
        <p>
          Useful to visualise a calculation, but rather heavy on the browser.
        </p>

        <figure id="waveform" class="">
          <style contenteditable="plaintext-only" spellcheck="false">
            #waveform {
              osc-dot {
                animation: var(--osc);
                --osc-state: paused; /* change this to running */
                translate: 0 calc(var(--osc-sin) * 40px * var(--osc-env));
              }
            }
          </style>
          <osc-stage class="ch waveform">
            <script type="module">

            // replace this script tag with 100 osc-dot elements
            for (let i = 0; i < 100; i++) {
              const dot = document.createElement('osc-dot')
              dot.style.setProperty('--osc-phase', `${i / 100}s`)
              document.querySelector('#waveform osc-stage').append(dot)
            }
            </script>
          </osc-stage>
        </figure>
      </article>

    </main>

    <footer>

    </footer>

    <script type="module">
    const removeIndent = (input) => {
      const lines = input.split('\n')
      while (lines.length > 0 && lines.at(0).trim() === '') lines.shift()
      while (lines.length > 0 && lines.at(-1).trim() === '') lines.pop()
      const indentLength = lines.at(0).match(/^\s*/).at(0).length
      return lines.map(line => line.slice(indentLength)).join('\n')
    }

    document.querySelectorAll("figure style").forEach(s => s.innerHTML = removeIndent(s.innerHTML))
    </script>
</body>
</html>
